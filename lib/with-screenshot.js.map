{"version":3,"sources":["../src/with-screenshot.js"],"names":["withScreenshot","options","storyFn","ctx","useDecorator","channel","getChannel","wrapperWithContext","context","props","err","emit","COMPONENT_ERROR","Error"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAEA,IAAMA,iBAAiB,SAAjBA,cAAiB;AAAA,MAACC,OAAD,uEAAW,EAAX;AAAA,SAAkB,UAACC,OAAD,EAAUC,GAAV,EAAkB;AACzD,QAAMC,eAAe,CAAC,CAACD,GAAvB;AACA,QAAME,UAAU,iBAAOC,UAAP,EAAhB;;AAEA,QAAMC,qBAAqB,SAArBA,kBAAqB,CAACC,OAAD,EAAa;AACtC,UAAMC,qBACD,+CAAuBR,OAAvB,CADC;AAEJI,wBAFI;AAGJG;AAHI,QAAN;;AAMA,aACE;AAAA;AAAuBC,aAAvB;AACGP,gBAAQM,OAAR;AADH,OADF;AAKD,KAZD;;AAcA,QAAI,OAAON,OAAP,KAAmB,UAAvB,EAAmC;AACjC,UAAMQ,qDAAmD,2BAAOR,OAAP,CAAnD,OAAN;AACAG,cAAQM,IAAR,CAAa,sBAAWC,eAAxB,EAAyCF,GAAzC,EAFiC,CAEc;AAC/C,YAAM,IAAIG,KAAJ,CAAUH,GAAV,CAAN,CAHiC,CAGX;AACvB;;AAED,QAAIN,YAAJ,EAAkB;AAChB,aAAOG,mBAAmBJ,GAAnB,CAAP;AACD;;AAED,WAAO;AAAA,aACLI,mBAAmBC,OAAnB,CADK;AAAA,KAAP;AAGD,GA/BsB;AAAA,CAAvB;;kBAiCeR,c","file":"with-screenshot.js","sourcesContent":["import React from 'react';\nimport addons from '@storybook/addons';\nimport insect from 'util-inspect';\nimport { EventTypes } from './constants';\nimport { mergeScreenshotOptions } from './screenshot-options';\nimport ScreenshotWrapper from './components/ScreenshotWrapper';\n\nconst withScreenshot = (options = {}) => (storyFn, ctx) => {\n  const useDecorator = !!ctx;\n  const channel = addons.getChannel();\n\n  const wrapperWithContext = (context) => {\n    const props = {\n      ...mergeScreenshotOptions(options),\n      channel,\n      context,\n    };\n\n    return (\n      <ScreenshotWrapper {...props}>\n        {storyFn(context)}\n      </ScreenshotWrapper>\n    );\n  };\n\n  if (typeof storyFn !== 'function') {\n    const err = `The story may not be correct, (storyFn = \"${insect(storyFn)}\")`;\n    channel.emit(EventTypes.COMPONENT_ERROR, err); // For Puppeteer\n    throw new Error(err); // For browser\n  }\n\n  if (useDecorator) {\n    return wrapperWithContext(ctx);\n  }\n\n  return context => (\n    wrapperWithContext(context)\n  );\n};\n\nexport default withScreenshot;\n"]}